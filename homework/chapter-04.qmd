---
title: "Homework Chapter 4"
format: html
---

```{r}
#| include: false
g <- glue::glue
library(ggplot2)
sapply(list.files(here::here('R'), full.names = T), source)
```

`r get_lecture_homework(4)`

## Section 4.1

### Q1

$S = \{1,2,3,4,5,6\} = \{E_1, E_2, E_3, E_4, E_5, E_6\}$

$A = \{2\}$

### Q2

$B = \{2,4,6\}$

### Q3

$C = \{3,4,5,6\}$

### Q4

$D = \{1,2,3,4\}$

### Q5

$E = \{2,4,6\}$

### Q6

$F = \{\}$

### Q28

5 balls - R1, R2, R3, Y1, Y2

These are the 20 events using a tree like diagram
```{r}
x <- c("R1", "R2", "R3" , "Y1", "Y2")



purrr::map(seq_along(x), function(.i) {
    out <- tibble::tibble(
        first_draw = x[.i],
        second_draw = x[-.i]
    )
}) |> 
purrr::list_rbind() |> 
flextable::flextable() |> 
flextable::merge_v() |> 
flextable::theme_box()
```

## Section 4.2

```{r}
get_lecture_homework(5)
```

### 4.2.7-4.2.10

7 Events, E7 has twice the probability.

Events 1-6 have probability _x_, E7 has probability 2x


$$
P(E_1) + P(E_2) + P(E_3) + P(E_4) + P(E_5) + P(E_6) + P(E_7) = 1
$$

$$
x + x + x +x +x +x + 2x = 1 = 8x
$$

$$
x = \frac{1}{8}
$$


#### 4.2.7

$$
x + x +x = \frac{3}{8}
$$

#### 4.2.8

$$
x  + x + x + 2x = \frac{5}{8}
$$


#### 4.2.9

$$
x + x = \frac{2}{8}
$$

#### 4.2.10

All three are not possible - therefore probability = 0

### 4.2.27

Part a:

Total must some to 1 therefore

$$
1 = .49 + .21 + .09 + ?
$$

Remaining probability = 0.21

Part b:


$$
.49 + .21  + .21 = .91 = 1 - .09
$$

### 4.2.36

Use tree diagram to show all simple events:



```{r}
x <- c("John", "Bill", "Ed", "Dave")

x_d <- expand.grid(first = x,
second = x,
third = x,
fourth = x) 

proper_combinations <- apply(x_d, MARGIN = 1, dplyr::n_distinct) == 4



all_comb <- x_d[proper_combinations, ] |> 
dplyr::mutate(probability = "1/24") |> 
dplyr::arrange(first, second, third, fourth) |> 
flextable::flextable() |> 
flextable::merge_v(j = -5)
all_comb
```

#### Part a

```{r}
all_comb |> 
flextable::bg(
    i = ~first=="Dave",
    j = ~probability,
    bg = "yellow"
)

```

6/24 = 1/4

#### Part b


```{r}
all_comb |> 
flextable::bg(
    i = ~first=="Dave" & second == "John",
    j = ~probability,
    bg = "yellow"
)

```

2/24

#### Part c

```{r}
all_comb |> 
flextable::bg(
    i = ~fourth=="Ed" ,
    j = ~probability,
    bg = "yellow"
)
```

6/24 = 1/4


## Section 4.3

```{r}
#| include: false
library(combinat)
```

### 4.3.1

$10 \times 8 = 80$

### 4.3.2

$4 \times 7 \times 3 = 84$

### 4.3.5-12

```{r}
perm <- function(n, k) {
    prod(tail(seq.int(n), k))
}

```


- 4.3.5: `r perm(5,3)`
- 4.3.6: `r perm(10,9)`
- 4.3.7: `r perm(6,6)`
- 4.3.8: `r perm(20,1)`

- 4.3.9: `r choose(5,3)`
- 4.3.10: `r choose(10,9)`
- 4.3.11: `r choose(6,6)`
- 4.3.12: `r choose(20,1)`

### 4.3.13

$$
P^8_5 = 6720
$$


### 4.3.16

$$
4 \times 12 \times 4 = 192
$$

### 4.3.19

Part A:
- 3 stages with n = 52 for each:
- $52 \times 52 \times 52 = 140,608$

Part B:

- 3 stages with n = 52, 51, and 50, respectively
- $52 \times 51 \times 50 = 132,600$


Part C:
- 1st stage - pick any card = 52
- 2nd stage - 1 option same card as the previous person
- 3rd stage - 1 option - same card as previous

- Total options from part A
- Probability of same card = $52/140608 = 0.00037$

Part D 

- Probability that all thre students pick different cards:
- Part B/Part A = $132600/140608 = 0.943$

### 4.3.21

Part A:
- order does not matter
- $C^52_5 = \frac{52!}{(52 - 5)!5!} = 2,598,960

Part B:
- Only 4 different combinations

Part C:
- 4/2598960 = 0.00000154


### 4.3.24

Part A

- $C^5_2 = 30$

Part B:

- 1/30


### 4.3.28

- Part A:  $4 \times 3 \times 2 \times 1 = 24$
- Part B: If dave wins sprint there are $1 \times 3 \times 2 \times 1 = 6$ total ways he can win. Probability = 6/24

- Part C: $1 \times 1 \times 2 \times 1 = 2$ Porbability = 2/24
- Part D: There are 3 options for first (any but Ed), 2 options for second (not and and not first), 1 option for 3rd left and Ed for fourth. Prob = 6/24

### 4.3.29

Total ways to draw the shapes:
$ 12! = 479,001,600$

How many ways to group them when drawing them?
$12 \times 2 \times 1 \times 9 \times 2 \times 1 \times 6 \times 2 \times 1 \times 3 \times 2 \times 1 = 31,104$

Probability = $31104/479001600 = 0.00006494 $

## Section 4.4
