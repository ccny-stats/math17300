---
title: "Homework Chapter 4"
format: html
---

```{r}
#| include: false
g <- glue::glue
library(ggplot2)
sapply(list.files(here::here('R'), full.names = T), source)
```

`r get_lecture_homework(4)`

## Section 4.1

### Q1

$S = \{1,2,3,4,5,6\} = \{E_1, E_2, E_3, E_4, E_5, E_6\}$

$A = \{2\}$

### Q2

$B = \{2,4,6\}$

### Q3

$C = \{3,4,5,6\}$

### Q4

$D = \{1,2,3,4\}$

### Q5

$E = \{2,4,6\}$

### Q6

$F = \{\}$

### Q28

5 balls - R1, R2, R3, Y1, Y2

These are the 20 events using a tree like diagram
```{r}
x <- c("R1", "R2", "R3" , "Y1", "Y2")



purrr::map(seq_along(x), function(.i) {
    out <- tibble::tibble(
        first_draw = x[.i],
        second_draw = x[-.i]
    )
}) |> 
purrr::list_rbind() |> 
flextable::flextable() |> 
flextable::merge_v() |> 
flextable::theme_box()
```

## Section 4.2

```{r}
get_lecture_homework(5)
```

### 4.2.7-4.2.10

7 Events, E7 has twice the probability.

Events 1-6 have probability _x_, E7 has probability 2x


$$
P(E_1) + P(E_2) + P(E_3) + P(E_4) + P(E_5) + P(E_6) + P(E_7) = 1
$$

$$
x + x + x +x +x +x + 2x = 1 = 8x
$$

$$
x = \frac{1}{8}
$$


#### 4.2.7

$$
x + x +x = \frac{3}{8}
$$

#### 4.2.8

$$
x  + x + x + 2x = \frac{5}{8}
$$


#### 4.2.9

$$
x + x = \frac{2}{8}
$$

#### 4.2.10

All theree are not possible - therefore probability = 0

### 4.2.27

Part a:

Total must some to 1 therefore

$$
1 = .49 + .21 + .09 + ?
$$

Remaining probability = 0.21

Part b:


$$
.49 + .21  + .21 = .91 = 1 - .09
$$

### 4.2.36

Use tree diagram to show all simple events:



```{r}
x <- c("John", "Bill", "Ed", "Dave")

x_d <- expand.grid(first = x,
second = x,
third = x,
fourth = x) 

proper_combinations <- apply(x_d, MARGIN = 1, dplyr::n_distinct) == 4



all_comb <- x_d[proper_combinations, ] |> 
dplyr::mutate(probability = "1/24") |> 
dplyr::arrange(first, second, third, fourth) |> 
flextable::flextable() |> 
flextable::merge_v(j = -5)
all_comb
```

#### Part a

```{r}
all_comb |> 
flextable::bg(
    i = ~first=="Dave",
    j = ~probability,
    bg = "yellow"
)

```

6/24 = 1/4

#### Part b


```{r}
all_comb |> 
flextable::bg(
    i = ~first=="Dave" & second == "John",
    j = ~probability,
    bg = "yellow"
)

```

2/24

#### Part c

```{r}
all_comb |> 
flextable::bg(
    i = ~fourth=="Ed" ,
    j = ~probability,
    bg = "yellow"
)
```

6/24 = 1/4


## Section 4.3

```{r}
library(combinat)
```

### 4.3.1

$10 \times 8 = 80$

### 4.3.2

$4 \times 7 \times 3 = 84$

### 4.3.5-12

```{r}
perm <- function(n, k) {
    prod(tail(seq.int(n), k))
}

```


- 4.3.5: `r perm(5,3)`
- 4.3.6: `r perm(10,9)`
- 4.3.7: `r perm(6,6)`
- 4.3.8: `r perm(20,1)`

- 4.3.9: `r choose(5,3)`
- 4.3.10: `r choose(10,9)`
- 4.3.11: `r choose(6,6)`
- 4.3.12: `r choose(20,1)`

### 4.3.13

$$
P^8_5 = 6720
$$


### 4.3.16

$$
4 \times 12 \times 4 = 192
$$

### 4.3.19

### 4.3.21

### 4.3.22

### 4.3.24

### 4.3.28

### 4.3.29
